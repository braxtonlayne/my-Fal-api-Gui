<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FAL AI GUI</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>FAL AI Creative Suite</h1>

    <div class="container">
        <div class="controls-panel">
            <div class="api-key-section card">
                <h3>API Key</h3>
                <label for="apiKey">FAL API Key:</label>
                <input type="text" id="apiKey" placeholder="Enter your FAL API Key">
                <button id="saveApiKey" type="button">Save API Key</button>
                <button id="clearApiKey" type="button">Clear API Key</button>
                <div id="apiKeyStatus" style="margin-top: 5px;"></div>
            </div>

            <div class="global-settings-section card">
                <h3>Global Settings</h3>
                <div>
                    <label for="safetyLevelSetting">Safety Level:</label>
                    <select id="safetyLevelSetting" name="safetyLevel">
                        <option value="default" selected>Default</option>
                        <option value="strict">Strict</option>
                        <option value="none">None (Disabled)</option>
                    </select>
                    <small>Model-specific safety features will be applied based on this setting if the model supports them.</small>
                </div>
            </div>

            <div class="mode-selector-section card">
                <h3>Mode</h3>
                <div id="modeSelector">
                    <label><input type="radio" name="mode" value="txt2img" checked> Text-to-Image</label>
                    <label><input type="radio" name="mode" value="img2img"> Image-to-Image</label>
                    <label><input type="radio" name="mode" value="inpaint"> Inpainting</label>
                    <label><input type="radio" name="mode" value="upscale"> Upscaling</label>
                    <label><input type="radio" name="mode" value="bgremove"> Background Removal</label>
                    <label><input type="radio" name="mode" value="video"> Video Generation</label>
                </div>
            </div>

            <div id="txt2imgControls" class="mode-controls card">
                <h3>Text-to-Image Settings</h3>
                <div>
                    <label for="modelSelection">Select Model:</label>
                    <select id="modelSelection" name="model">
                        <!-- Options will be populated by script.js -->
                    </select>
                </div>
                <div id="dynamicTxt2ImgControlsContainer">
                    <!-- Dynamically generated controls will appear here -->
                </div>
                <div>
                    <button id="generateButton" type="button">Generate Text-to-Image</button>
                </div>
            </div>

            <div id="img2imgControls" class="mode-controls card" style="display:none;">
                <h3>Image-to-Image Settings</h3>
                <div>
                    <label for="img2imgModelSelection">Select Model:</label>
                    <select id="img2imgModelSelection" name="img2imgModel">
                        <!-- Options will be populated by script.js -->
                    </select>
                </div>
                <div id="dynamicImg2ImgControlsContainer">
                    <!-- Dynamically generated controls will appear here -->
                </div>
                <div>
                    <button id="generateImg2ImgButton" type="button">Generate Image-to-Image</button>
                </div>
            </div>

            <div id="inpaintControls" class="mode-controls card" style="display:none;">
                <h3>Inpainting Settings</h3>
                <div>
                    <label for="inpaintModelSelection">Select Inpainting Model:</label>
                    <select id="inpaintModelSelection" name="inpaintModel">
                        <!-- Options will be populated by script.js -->
                    </select>
                </div>
                <!-- Canvas for inpainting mask should remain static -->
                <div id="canvasContainer" style="position: relative; width: 512px; height: 512px; border: 1px solid black; margin-top: 10px; margin-bottom: 10px; background-color: #eee;">
                    <canvas id="imageCanvas" width="512" height="512" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
                    <canvas id="maskCanvas" width="512" height="512" style="position: absolute; left: 0; top: 0; z-index: 2; opacity: 0.6; cursor: crosshair;"></canvas>
                </div>
                <div>
                    <label for="brushSize">Brush Size:</label>
                    <input type="range" id="brushSize" min="5" max="80" value="30" style="vertical-align: middle;"> <span id="brushSizeValue">30px</span>
                    <button id="clearMaskButton" type="button" style="margin-left: 15px;">Clear Mask</button>
                </div>
                <div id="dynamicInpaintControlsContainer">
                    <!-- Dynamically generated controls will appear here -->
                </div>
                <div>
                    <button id="generateInpaintButton" type="button">Generate Inpainting</button>
                </div>
            </div>

            <div id="upscaleControls" class="mode-controls card" style="display:none;">
                <h3>Image Upscaling Settings</h3>
                <div>
                    <label for="upscaleModelSelection">Select Upscaler Model:</label>
                    <select id="upscaleModelSelection" name="upscaleModel">
                        <!-- Options will be populated by script.js -->
                    </select>
                </div>
                <div id="dynamicUpscaleControlsContainer">
                    <!-- Dynamically generated controls will appear here -->
                </div>
                <div>
                    <button id="generateUpscaleButton" type="button">Upscale Image</button>
                </div>
            </div>

            <div id="bgRemoveControls" class="mode-controls card" style="display:none;">
                <h3>Background Removal Settings</h3>
                <div>
                    <label for="bgRemoveModelSelection">Select Background Removal Model:</label>
                    <select id="bgRemoveModelSelection" name="bgRemoveModel">
                        <!-- Options will be populated by script.js -->
                    </select>
                </div>
                <div id="dynamicBgRemoveControlsContainer">
                    <!-- Dynamically generated controls will appear here -->
                </div>
                <div>
                    <button id="generateBgRemoveButton" type="button">Remove Background</button>
                </div>
            </div>

            <div id="videoControls" class="mode-controls card" style="display:none;">
                <h3>Video Generation Settings</h3>
                <div>
                    <label for="videoModelSelection">Select Model:</label>
                    <select id="videoModelSelection" name="videoModel">
                        <!-- Options will be populated by script.js -->
                    </select>
                </div>
                <div id="dynamicVideoControlsContainer">
                    <!-- Dynamically generated controls will appear here -->
                </div>
                <div>
                    <button id="generateVideoButton" type="button">Generate Video</button>
                </div>
            </div>

        </div> <!-- End .controls-panel -->

        <div class="results-history-panel">
            <div class="results-area-card card">
                <h2>Results</h2>
                <div id="statusArea"></div>
                <div id="imageResultArea">
                    <!-- Results will be dynamically added here -->
                </div>
            </div>

            <div class="history-area-card card">
                <h2>Generation History</h2>
                <button id="clearHistoryButton" type="button">Clear All History</button>
                <div id="historyGallery">
                    <!-- History items (thumbnails) will be added here -->
                </div>
            </div>
        </div> <!-- End .results-history-panel -->
    </div> <!-- End .container -->

    <div id="loadingOverlay" style="display:none;">
        <div class="spinner"></div>
        <p id="loadingMessage" style="margin-left: 15px;">Loading...</p>
    </div>
    <script src="{{ url_for('static', filename='model_schemas.js') }}"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
